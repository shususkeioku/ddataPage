---
title: "Diplomatic Relations Visualized"
filters:
  - shinylive
---

```{shinylive-r}
#| standalone: true
#| viewerHeight: 600

library(tidyverse)
library(shiny)
library(leaflet)
library(geosphere)
library(ggplot2)
library(maps)
library(RCurl)

d <- getURL("https://raw.githubusercontent.com/shususkeioku/ddataPage/main/adg.csv")
data <- read_csv(text = d)

# UI
ui <- fluidPage(
  titlePanel("Diplomatic Ties Visualization"),
  sidebarLayout(
    sidebarPanel(
      sliderInput("year", "Select Year", 
                  min = min(data$year), 
                  max = max(data$year), 
                  value = min(data$year),
                  step = 1)
    ),
    mainPanel(
      plotOutput("world_map")
    )
  )
)

# Server
server <- function(input, output) {
  output$world_map <- renderPlot({
    filtered_data <- data %>%
      filter(year == input$year)
    
    world <- map_data("world")
    
    ggplot() +
      geom_polygon(data = world, aes(x = long, y = lat, group = group), fill = "lightgray", color = "white") +
      geom_curve(data = filtered_data, aes(x = lon180.x, y = lat.x, xend = lon180.y, yend = lat.y),
                 curvature = 0.2, color = "blue", size = 0.5, alpha = 0.5) +
      coord_fixed() +
      theme_minimal() +
      theme(axis.text = element_blank(),
            axis.title = element_blank(),
            panel.grid = element_blank())
  })
}

# Run the application 
shinyApp(ui = ui, server = server)
```
