[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Diplomatic Representation Data",
    "section": "",
    "text": "#| standalone: true\n#| viewerHeight: 600\n\nlibrary(tidyverse)\nlibrary(shiny)\nlibrary(leaflet)\nlibrary(geosphere)\nlibrary(ggplot2)\nlibrary(maps)\n\ndata_url &lt;- \"https://raw.githubusercontent.com/shususkeioku/ddataPage/main/adg.csv\"\ndownload.file(data_url, \"data.csv\")\nreadLines(url(data_url))\ndata &lt;- read.csv(data_url)\n\n# UI\nui &lt;- fluidPage(\n  titlePanel(\"Diplomatic Ties Visualized\"),\n  sidebarLayout(\n    sidebarPanel(\n      sliderInput(\"year\", \"Select Year\", \n                  min = min(data$year), \n                  max = max(data$year), \n                  value = min(data$year),\n                  step = 1),\n      checkboxGroupInput(\n        \"dm\", \"Mission Rank\",\n        c(\"Ambassador\" = 1, \"Minister\" = 2, \"Charge d'Affaires\" = 3, \"Consul\" = 4, \"Other\" = 5),\n        c(1, 2, 3, 4, 5)\n      ),\n      selectInput(\"sen\", \"Sender:\",\n        append(data$ccodes, \"ALL\"), \"ALL\"\n      ),\n      selectInput(\"rec\", \"Receiver:\",\n        append(data$ccoder, \"ALL\"), \"ALL\"\n      ),\n    ),\n    mainPanel(\n      plotOutput(\"world_map\")\n    )\n  )\n)\n\n# Server\nserver &lt;- function(input, output) {\n  output$world_map &lt;- renderPlot({\n    if (input$sen == \"ALL\" & input$rec == \"ALL\") {\n      filtered_data &lt;- data %&gt;%\n        filter(year == input$year, dm %in% input$dm)\n    } else if (input$sen == \"ALL\") {\n      filtered_data &lt;- data %&gt;%\n        filter(year == input$year, dm %in% input$dm, ccoder == input$rec)\n    } else if (input$rec == \"ALL\") {\n      filtered_data &lt;- data %&gt;%\n        filter(year == input$year, dm %in% input$dm, ccodes == input$sen)\n    } else {\n      filtered_data &lt;- data %&gt;%\n        filter(year == input$year, dm %in% input$dm, ccodes == input$sen, ccoder == input$rec) \n    }\n    \n    world &lt;- map_data(\"world\")\n    \n    ggplot() +\n      geom_polygon(data = world, aes(x = long, y = lat, group = group), fill = \"lightgray\", color = \"white\") +\n      geom_curve(data = filtered_data, aes(x = lon180.x, y = lat.x, xend = lon180.y, yend = lat.y, color = dm),\n                 curvature = 0.2, size = 0.5, alpha = 0.5) +\n      coord_fixed() +\n      theme_minimal() +\n      theme(axis.text = element_blank(),\n            axis.title = element_blank(),\n            panel.grid = element_blank())\n  })\n}\n\n# Run the application \nshinyApp(ui = ui, server = server)"
  }
]